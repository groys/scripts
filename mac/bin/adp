#!/usr/bin/python

import optparse
import sys
import os
import subprocess
import shlex
import tempfile
from subprocess import PIPE


cmd = "/Users/groys/code-disk/fb_devtools/arcanist/bin/arc diff --preview"
cmdargs = shlex.split(cmd)
cmdargs += sys.argv[1:]
print cmdargs
ss = subprocess.Popen(cmdargs, stdout=subprocess.PIPE)
commandout = ss.communicate()[0]
print commandout
for line in commandout.split('\n'):
    print line
    if 'Diff URI' in line:
        url = line.split()[2]

if url:
    print "diff url %s" %url
    subprocess.call(['open', url ])
else:
    print commandout
